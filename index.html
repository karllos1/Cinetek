<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CINETEK ULTIMATE V100</title>
    <style>
        :root { --red: #E50914; --bg: #050505; --text: #ffffff; }
        
        body {
            background: var(--bg); color: var(--text); font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0; padding: 0; overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        header {
            background: rgba(0,0,0,0.95); height: 70px; display: flex; justify-content: space-between;
            align-items: center; padding: 0 5%; position: fixed; width: 100%; top: 0; z-index: 5000; box-sizing: border-box;
            border-bottom: 1px solid #222;
        }
        
        .btn-menu-novo { background: none; border: none; color: white; font-size: 28px; cursor: pointer; }

        .search-container {
            display: flex; align-items: center; background: #1a1a1a; border-radius: 25px;
            padding: 5px 15px; flex: 1; max-width: 300px; margin: 0 10px; border: 1px solid #333;
        }
        .search-container input { background: none; border: none; color: white; width: 100%; outline: none; font-size: 14px; }

        #hero-slider {
            width: 100%; height: 65vh; background-size: cover; background-position: top center; 
            transition: 1.5s ease-in-out; position: relative; display: flex; 
            align-items: flex-end; padding: 60px 5%; box-sizing: border-box;
        }
        #hero-slider::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to top, var(--bg) 10%, transparent 70%);
        }

        #menu-lat {
            position: fixed; left: -300px; top: 0; width: 280px; height: 100%;
            background: #000; z-index: 9999; transition: 0.4s; padding: 40px 20px;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }
        #menu-lat.active { left: 0; }
        .menu-item { display: block; width: 100%; padding: 15px; color: white; background: none; border: none; text-align: left; cursor: pointer; font-size: 17px; border-bottom: 1px solid #111; }

        .secao-tit { padding: 20px 5% 10px; font-size: 1.3rem; color: var(--red); font-weight: bold; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; padding: 10px 5%; }
        .card { cursor: pointer; text-align: center; transition: 0.3s; }
        .card img { width: 100%; border-radius: 8px; aspect-ratio: 2/3; object-fit: cover; }
        .card p { margin: 8px 0; font-size: 12px; color: #bbb; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .carousel-container { display: flex; overflow-x: auto; gap: 15px; padding: 10px 5%; scroll-behavior: smooth; }
        .carousel-container::-webkit-scrollbar { display: none; }
        .carousel-item { flex: 0 0 130px; cursor: pointer; text-align: center; }
        .carousel-item img { width: 100%; border-radius: 8px; aspect-ratio: 2/3; object-fit: cover; border: 1px solid #333; }

        #detalhes-page { display: none; position: fixed; inset: 0; background: var(--bg); z-index: 8000; overflow-y: auto; padding-top: 70px; }
        .detalhes-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(5,5,5,0.8) 0%, rgba(5,5,5,1) 100%); z-index: -1; }
        .det-flex { display: flex; gap: 20px; padding: 20px 5%; max-width: 1200px; margin: 0 auto; flex-wrap: wrap; }
        .det-poster-img { width: 200px; border-radius: 12px; }
        .det-info { flex: 1; min-width: 300px; }

        .player-wrap { width: 100%; background: #000; border-radius: 10px; overflow: hidden; margin: 15px 0; border: 1px solid var(--red); display: none; }
        video { width: 100%; aspect-ratio: 16/9; }

        .ep-list { display: grid; gap: 10px; margin-top: 10px; max-height: 250px; overflow-y: auto; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; }
        .ep-card { background: #1a1a1a; padding: 12px; border-radius: 5px; cursor: pointer; border-left: 4px solid #333; transition: 0.3s; }
        .ep-card.has-link { border-left-color: var(--red); }

        .modal-admin { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 10000; padding: 20px; overflow-y: auto; }
        .admin-box { background: #111; max-width: 500px; margin: 20px auto; padding: 20px; border-radius: 10px; border: 1px solid #333; }
        .admin-input { width: 100%; padding: 12px; margin-bottom: 10px; background: #222; border: 1px solid #444; color: white; border-radius: 5px; box-sizing: border-box; }
        
        .btn-play { background: var(--red); color: white; border: none; padding: 12px 30px; border-radius: 5px; font-weight: bold; cursor: pointer; }
        
        @media (max-width: 768px) { .det-flex { flex-direction: column; align-items: center; text-align: center; } }
    </style>
</head>
<body>

<header>
    <button class="btn-menu-novo" onclick="toggleMenu(true)">‚ò∞</button>
    <div style="color:var(--red); font-weight:bold; font-size:22px;">CINETEK</div>
    <div class="search-container"><input type="text" id="home-search" placeholder="Pesquisar..." onkeyup="if(event.key==='Enter') pesquisaGeral()"></div>
    <button onclick="abrirAdmin()" style="background:none; border:none; color:white; font-size:22px;">‚öô</button>
</header>

<div id="hero-slider">
    <div style="z-index:10; position:relative;"><h1 id="hero-tit" style="margin:0; font-size:2rem; text-shadow: 2px 2px 10px #000;">CINETEK PRO</h1></div>
</div>

<div id="home">
    <h2 class="secao-tit">‚ú® Adicionados Recentemente</h2>
    <div class="grid" id="grid-recentes"></div>
    <h2 class="secao-tit" id="main-tit">üî• EM ALTA</h2>
    <div class="grid" id="main-grid"></div>
</div>

<div id="menu-lat">
    <button onclick="toggleMenu(false)" style="color:var(--red); background:none; border:none; font-size:35px;">‚úï</button>
    <button class="menu-item" onclick="buscarGen(0, 'all')">üè† In√≠cio</button>
    <button class="menu-item" onclick="buscarGen(0, 'movie')">üé¨ Filmes</button>
    <button class="menu-item" onclick="buscarGen(0, 'tv')">üì∫ S√©ries</button>
    <button class="menu-item" onclick="buscarGen(16, 'movie')">üé® Desenhos</button>
</div>

<div id="detalhes-page">
    <div class="detalhes-overlay" id="det-bg-blur"></div>
    <div class="det-flex">
        <img id="det-poster" class="det-poster-img">
        <div class="det-info">
            <h1 id="det-tit"></h1>
            <p id="det-meta"></p>
            
            <div id="player-box" class="player-wrap"><video id="main-video" controls playsinline></video></div>

            <div id="actions-area"><button id="btn-play-trigger" class="btn-play" style="display:none">‚ñ∂ ASSISTIR FILME</button></div>
            
            <div id="series-area" style="display:none">
                <h3>Temporadas</h3>
                <select id="select-temp" class="admin-input" onchange="carregarEpisodios()"></select>
                <div id="ep-list" class="ep-list"></div>
            </div>

            <p id="det-sinopse" style="margin:20px 0; color:#ccc;"></p>
            <h3 style="color:var(--red);">üé• Semelhantes</h3>
            <div class="carousel-container" id="grid-semelhantes"></div>
        </div>
    </div>
    <button onclick="fecharDet()" style="position:fixed; top:80px; right:20px; background:var(--red); color:white; border:none; width:40px; height:40px; border-radius:50%;">‚úï</button>
</div>

<div id="admin-modal" class="modal-admin">
    <div class="admin-box">
        <button onclick="fecharAdmin()" style="float:right; color:white; background:none; border:none;">‚úï</button>
        <div id="adm-login-area">
            <h2>Admin Individual</h2>
            <input type="password" id="adm-pass" class="admin-input" placeholder="Senha">
            <button onclick="login()" class="btn-play" style="width:100%;">ENTRAR</button>
        </div>

        <div id="adm-painel" style="display:none;">
            <div style="display:flex; gap:10px; margin-bottom:10px;">
                <button onclick="setTipo('movie')" id="btn-m" style="flex:1; padding:10px; background:red; color:white; border:none;">FILMES</button>
                <button onclick="setTipo('tv')" id="btn-t" style="flex:1; padding:10px; background:#333; color:white; border:none;">S√âRIES</button>
            </div>
            <input type="text" id="adm-busca" class="admin-input" placeholder="Buscar no TMDB..." oninput="buscarTMDB()">
            <div id="res-busca-adm" style="max-height:150px; overflow-y:auto; background:#000; margin-bottom:10px; border:1px solid #333;"></div>
            
            <div id="adm-editor-area" style="display:none; border-top:1px solid #333; pt-10px">
                <p id="adm-selected-name" style="color:var(--red); font-weight:bold;"></p>
                
                <div id="adm-movie-fields">
                    <input type="text" id="ed-link" class="admin-input" placeholder="Link do Filme (MP4/HLS)">
                </div>

                <div id="adm-tv-fields" style="display:none">
                    <select id="adm-temp-select" class="admin-input" onchange="carregarEpisodiosAdmin()"></select>
                    <div id="adm-ep-links" style="max-height: 200px; overflow-y:auto; background:#050505; padding:5px;"></div>
                </div>

                <button onclick="salvar()" class="btn-play" style="width:100%; margin-top:10px;">SALVAR TUDO</button>
            </div>
        </div>
    </div>
</div>

<script>
    const DATABASE_URL = "https://cinetek-db692-default-rtdb.firebaseio.com/.json"; 
    const API_KEY = "6442432c527127fa62c7fe3b9774b7eb";
    let db = { movie:{}, tv:{}, recentes:[] };
    let tipoAtual = 'movie'; let selecionado = null; let sliderItems = [];

    async function carregarBanco() {
        try { const r = await fetch(DATABASE_URL); const d = await r.json(); if(d) db=d; render(db.recentes||[], 'grid-recentes'); } catch(e){}
    }

    async function init() {
        await carregarBanco();
        const r = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json(); sliderItems = d.results.slice(0, 8);
        render(d.results, 'main-grid'); startSlider();
    }

    function render(lista, container) {
        const div = document.getElementById(container); div.innerHTML = "";
        lista.forEach(m => {
            const card = document.createElement('div');
            card.className = (container === 'grid-semelhantes') ? 'carousel-item' : 'card';
            card.innerHTML = `<img src="https://image.tmdb.org/t/p/w500${m.poster_path}"><p>${m.title || m.name}</p>`;
            card.onclick = () => abrirDet(m); div.appendChild(card);
        });
    }

    async function abrirDet(m) {
        selecionado = m; const tipo = m.name ? 'tv' : 'movie';
        document.getElementById('detalhes-page').style.display = 'block';
        document.getElementById('det-bg-blur').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
        document.getElementById('det-tit').innerText = m.title || m.name;
        document.getElementById('det-poster').src = `https://image.tmdb.org/t/p/w500${m.poster_path}`;
        document.getElementById('det-sinopse').innerText = m.overview;
        document.getElementById('player-box').style.display = 'none';

        if(tipo === 'tv') {
            document.getElementById('btn-play-trigger').style.display = 'none';
            document.getElementById('series-area').style.display = 'block';
            carregarTemporadas(m.id);
        } else {
            document.getElementById('series-area').style.display = 'none';
            document.getElementById('btn-play-trigger').style.display = 'block';
            document.getElementById('btn-play-trigger').onclick = () => {
                if(db.movie[m.id]) {
                    document.getElementById('player-box').style.display = 'block';
                    document.getElementById('main-video').src = db.movie[m.id].link;
                } else alert("Em breve!");
            };
        }
        const rs = await fetch(`https://api.themoviedb.org/3/${tipo}/${m.id}/similar?api_key=${API_KEY}&language=pt-BR`);
        const ds = await rs.json(); render(ds.results.slice(0, 10), 'grid-semelhantes');
    }

    // --- FUN√á√ïES DE S√âRIE ---
    async function carregarTemporadas(id) {
        const r = await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json(); 
        document.getElementById('select-temp').innerHTML = d.seasons.map(s => `<option value="${s.season_number}">${s.name}</option>`).join('');
        carregarEpisodios();
    }

    async function carregarEpisodios() {
        const sNum = document.getElementById('select-temp').value;
        const r = await fetch(`https://api.themoviedb.org/3/tv/${selecionado.id}/season/${sNum}?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json();
        const epContainer = document.getElementById('ep-list');
        epContainer.innerHTML = d.episodes.map(e => {
            const hasLink = (db.tv[selecionado.id] && db.tv[selecionado.id][`s${sNum}e${e.episode_number}`]);
            return `<div class="ep-card ${hasLink?'has-link':''}" onclick="tocarEp(${sNum}, ${e.episode_number})">EP ${e.episode_number} - ${e.name}</div>`;
        }).join('');
    }

    function tocarEp(s, e) {
        const key = `s${s}e${e}`;
        if(db.tv[selecionado.id] && db.tv[selecionado.id][key]) {
            document.getElementById('player-box').style.display = 'block';
            document.getElementById('main-video').src = db.tv[selecionado.id][key];
            document.getElementById('player-box').scrollIntoView();
        } else alert("Epis√≥dio sem link.");
    }

    // --- ADMIN ---
    function login() { if(document.getElementById('adm-pass').value==='1234') { document.getElementById('adm-login-area').style.display='none'; document.getElementById('adm-painel').style.display='block'; } }
    
    function setTipo(t) { 
        tipoAtual = t; 
        document.getElementById('btn-m').style.background = t=='movie'?'red':'#333'; 
        document.getElementById('btn-t').style.background = t=='tv'?'red':'#333'; 
        document.getElementById('adm-editor-area').style.display = 'none';
    }

    async function buscarTMDB() {
        const q = document.getElementById('adm-busca').value; if(q.length<3) return;
        const r = await fetch(`https://api.themoviedb.org/3/search/${tipoAtual}?api_key=${API_KEY}&query=${q}&language=pt-BR`);
        const d = await r.json();
        document.getElementById('res-busca-adm').innerHTML = d.results.map(m => `<div onclick='selecionarParaEditar(${JSON.stringify(m).replace(/'/g, "")})' style="padding:10px; border-bottom:1px solid #222; cursor:pointer;">${m.title || m.name}</div>`).join('');
    }

    async function selecionarParaEditar(m) {
        selecionado = m;
        document.getElementById('adm-editor-area').style.display = 'block';
        document.getElementById('adm-selected-name').innerText = "Editando: " + (m.title || m.name);
        
        if(tipoAtual === 'movie') {
            document.getElementById('adm-movie-fields').style.display = 'block';
            document.getElementById('adm-tv-fields').style.display = 'none';
            document.getElementById('ed-link').value = (db.movie[m.id] ? db.movie[m.id].link : "");
        } else {
            document.getElementById('adm-movie-fields').style.display = 'none';
            document.getElementById('adm-tv-fields').style.display = 'block';
            const r = await fetch(`https://api.themoviedb.org/3/tv/${m.id}?api_key=${API_KEY}&language=pt-BR`);
            const d = await r.json();
            document.getElementById('adm-temp-select').innerHTML = d.seasons.map(s => `<option value="${s.season_number}">${s.name}</option>`).join('');
            carregarEpisodiosAdmin();
        }
    }

    async function carregarEpisodiosAdmin() {
        const sNum = document.getElementById('adm-temp-select').value;
        const r = await fetch(`https://api.themoviedb.org/3/tv/${selecionado.id}/season/${sNum}?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json();
        const area = document.getElementById('adm-ep-links');
        area.innerHTML = d.episodes.map(e => {
            const val = (db.tv[selecionado.id] && db.tv[selecionado.id][`s${sNum}e${e.episode_number}`]) ? db.tv[selecionado.id][`s${sNum}e${e.episode_number}`] : "";
            return `<label style="font-size:12px">EP ${e.episode_number}</label>
                    <input type="text" class="admin-input ep-link-input" data-key="s${sNum}e${e.episode_number}" value="${val}" placeholder="Link do EP">`;
        }).join('');
    }

    async function salvar() {
        if(tipoAtual === 'movie') {
            if(!db.movie) db.movie = {};
            db.movie[selecionado.id] = { ...selecionado, link: document.getElementById('ed-link').value };
        } else {
            if(!db.tv) db.tv = {};
            if(!db.tv[selecionado.id]) db.tv[selecionado.id] = { ...selecionado };
            document.querySelectorAll('.ep-link-input').forEach(input => {
                if(input.value) db.tv[selecionado.id][input.dataset.key] = input.value;
            });
        }
        db.recentes = db.recentes.filter(x => x.id != selecionado.id);
        db.recentes.unshift(selecionado);
        await fetch(DATABASE_URL, { method: 'PUT', body: JSON.stringify(db) });
        alert("Dados salvos com sucesso!"); location.reload();
    }

    function startSlider() {
        let idx = 0; setInterval(() => {
            const m = sliderItems[idx]; if(m) {
                document.getElementById('hero-slider').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
                document.getElementById('hero-tit').innerText = m.title || m.name; idx = (idx + 1) % sliderItems.length;
            }
        }, 5000);
    }
    function toggleMenu(s) { document.getElementById('menu-lat').classList.toggle('active', s); }
    function fecharDet() { document.getElementById('detalhes-page').style.display='none'; document.getElementById('main-video').src=""; }
    function abrirAdmin() { document.getElementById('admin-modal').style.display='block'; }
    function fecharAdmin() { document.getElementById('admin-modal').style.display='none'; }
    async function pesquisaGeral() {
        const q = document.getElementById('home-search').value;
        const r = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${q}&language=pt-BR`);
        const d = await r.json(); render(d.results, 'main-grid');
    }
    async function buscarGen(id, tipo) {
        toggleMenu(false);
        let url = id === 0 ? `https://api.themoviedb.org/3/trending/${tipo}/week?api_key=${API_KEY}&language=pt-BR` : `https://api.themoviedb.org/3/discover/${tipo}?api_key=${API_KEY}&with_genres=${id}&language=pt-BR`;
        const r = await fetch(url); const d = await r.json(); render(d.results, 'main-grid');
    }
    init();
</script>
</body>
</html>
