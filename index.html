<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CINETEK ULTIMATE V100</title>
    <style>
        :root { --red: #E50914; --bg: #050505; --text: #ffffff; }
        
        body {
            background: var(--bg); color: var(--text); font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0; padding: 0; overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        /* CABE√áALHO */
        header {
            background: rgba(0,0,0,0.95); height: 70px; display: flex; justify-content: space-between;
            align-items: center; padding: 0 5%; position: fixed; width: 100%; top: 0; z-index: 5000; box-sizing: border-box;
            border-bottom: 1px solid #222;
        }
        
        .btn-menu-novo { background: none; border: none; color: white; font-size: 28px; cursor: pointer; }

        .search-container {
            display: flex; align-items: center; background: #1a1a1a; border-radius: 25px;
            padding: 5px 15px; flex: 1; max-width: 300px; margin: 0 10px; border: 1px solid #333;
        }
        .search-container input { background: none; border: none; color: white; width: 100%; outline: none; font-size: 14px; }

        /* BANNER */
        #hero-slider {
            width: 100%; height: 65vh; background-size: cover; background-position: top center; 
            transition: 1.5s ease-in-out; position: relative; display: flex; 
            align-items: flex-end; padding: 60px 5%; box-sizing: border-box;
        }
        #hero-slider::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to top, var(--bg) 10%, transparent 70%);
        }

        /* MENU LATERAL */
        #menu-lat {
            position: fixed; left: -300px; top: 0; width: 280px; height: 100%;
            background: #000; z-index: 9999; transition: 0.4s; padding: 40px 20px;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }
        #menu-lat.active { left: 0; }
        .menu-item { display: block; width: 100%; padding: 15px; color: white; background: none; border: none; text-align: left; cursor: pointer; font-size: 17px; border-bottom: 1px solid #111; }

        /* GRADES */
        .secao-tit { padding: 25px 5% 10px; font-size: 1.3rem; color: var(--red); font-weight: bold; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; padding: 10px 5%; }
        .card { cursor: pointer; text-align: center; transition: 0.3s; }
        .card:hover { transform: scale(1.05); }
        .card img { width: 100%; border-radius: 8px; aspect-ratio: 2/3; object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .card p { margin: 8px 0; font-size: 12px; color: #bbb; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* DETALHES */
        #detalhes-page {
            display: none; position: fixed; inset: 0; background: var(--bg); z-index: 8000;
            overflow-y: auto; padding-top: 80px; background-size: cover; background-position: center;
        }
        .detalhes-overlay {
            position: absolute; top: 0; left: 0; width: 100%; min-height: 100%;
            background: linear-gradient(to bottom, rgba(5,5,5,0.85) 0%, rgba(5,5,5,1) 100%);
            z-index: -1; backdrop-filter: blur(10px);
        }
        .det-flex { display: flex; gap: 30px; padding: 20px 5%; max-width: 1100px; margin: 0 auto; flex-wrap: wrap; position: relative; }
        .det-poster-img { width: 250px; border-radius: 12px; box-shadow: 0 0 30px rgba(0,0,0,0.9); border: 1px solid #333; }
        .det-info { flex: 1; min-width: 300px; }

        .player-wrap { width: 100%; max-width: 900px; margin: 20px 0; display: none; background: #000; border-radius: 15px; overflow: hidden; box-shadow: 0 0 20px var(--red); }
        video { width: 100%; aspect-ratio: 16/9; display: block; }
        .ep-list { display: grid; gap: 10px; margin-top: 15px; max-height: 350px; overflow-y: auto; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 10px; }
        .ep-card { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px; border: 1px solid rgba(255,255,255,0.1); }
        .ep-card.bloqueado { opacity: 0.5; cursor: not-allowed; }

        .sinopse-container { font-size: 16px; line-height: 1.8; color: #eee; margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.5); border-radius: 10px; }
        .btn-play { background: var(--red); color: white; border: none; padding: 15px 40px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; }

        /* ADMIN */
        .modal-admin { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 10000; padding: 20px; overflow-y: auto; }
        .admin-box { background: #111; max-width: 450px; margin: 30px auto; padding: 25px; border-radius: 15px; border: 1px solid #333; position: relative; }
        .admin-input { width: 100%; padding: 12px; margin-bottom: 12px; background: #222; border: 1px solid #444; color: white; border-radius: 8px; box-sizing: border-box; }
        .close-admin { position: absolute; top: 15px; right: 15px; background: none; border: none; color: #fff; font-size: 24px; cursor: pointer; }

        @media (max-width: 768px) {
            .logo-txt { display: none; }
            #hero-slider { height: 45vh; }
            .det-flex { flex-direction: column; text-align: center; }
            .det-poster-img { width: 100%; max-width: 180px; margin: 0 auto; }
        }
    </style>
</head>
<body>

<header>
    <button class="btn-menu-novo" onclick="toggleMenu(true)">‚ò∞</button>
    <div style="color:var(--red); font-weight:bold; font-size:22px;" class="logo-txt">CINETEK</div>
    <div class="search-container">
        <input type="text" id="home-search" placeholder="Pesquisar..." onkeyup="if(event.key==='Enter') pesquisaGeral()">
        <span onclick="pesquisaGeral()" style="cursor:pointer">üîç</span>
    </div>
    <button onclick="abrirAdmin()" style="background:none; border:none; color:white; font-size:22px; cursor:pointer;">‚öô</button>
</header>

<div id="hero-slider">
    <div style="z-index:10; position:relative;"><h1 id="hero-tit" style="margin:0; font-size:2.5rem; text-shadow: 2px 2px 10px #000;">CINETEK PRO</h1></div>
</div>

<div id="home">
    <h2 class="secao-tit">‚ú® Adicionados Recentemente</h2>
    <div class="grid" id="grid-recentes"></div>
    <h2 class="secao-tit" id="main-tit">üî• EM ALTA</h2>
    <div class="grid" id="main-grid"></div>
</div>

<div id="menu-lat">
    <button onclick="toggleMenu(false)" style="color:var(--red); background:none; border:none; font-size:35px; cursor:pointer;">‚úï</button>
    <button class="menu-item" onclick="buscarGen(0, 'all')">üè† P√°gina Inicial</button>
    <button class="menu-item" onclick="buscarGen(0, 'movie')">üé¨ Filmes</button>
    <button class="menu-item" onclick="buscarGen(0, 'tv')">üì∫ S√©ries</button>
    <button class="menu-item" onclick="buscarGen(28, 'movie')">üí• A√ß√£o</button>
    <button class="menu-item" onclick="buscarGen(27, 'movie')">üíÄ Terror</button>
    <button class="menu-item" onclick="buscarGen(35, 'movie')">üòÇ Com√©dia</button>
    <button class="menu-item" onclick="buscarGen(16, 'movie')">üé® Desenhos</button>
</div>

<div id="detalhes-page">
    <div class="detalhes-overlay"></div>
    <div class="det-flex">
        <img id="det-poster" class="det-poster-img" src="">
        <div class="det-info">
            <h1 id="det-tit" style="font-size: 2.5rem; margin: 0; text-shadow: 2px 2px 10px #000;"></h1>
            <p id="det-meta" style="color:var(--red); font-weight:bold; margin-top: 10px;"></p>
            <div id="player-box" class="player-wrap"><video id="main-video" controls playsinline></video></div>
            <div id="actions-area"><button id="btn-play-trigger" class="btn-play">‚ñ∂ ASSISTIR AGORA</button></div>
            <div id="series-area" style="display:none; margin-top: 20px;">
                <h3 style="margin-bottom: 10px;">Temporadas e Epis√≥dios</h3>
                <select id="select-temp" class="admin-input" style="max-width: 200px;" onchange="carregarEpisodios()"></select>
                <div id="ep-list" class="ep-list"></div>
            </div>
            <div id="det-sinopse" class="sinopse-container"></div>
            <h3 class="secao-tit" style="padding-left: 0;">üé• T√≠tulos Semelhantes</h3>
            <div class="grid" id="grid-semelhantes" style="padding: 10px 0;"></div>
        </div>
    </div>
    <button onclick="fecharDet()" style="position:fixed; top:20px; right:20px; background:var(--red); color:white; border:none; width:45px; height:45px; border-radius:50%; cursor:pointer; z-index:9000; font-weight: bold;">‚úï</button>
</div>

<div id="admin-modal" class="modal-admin">
    <div class="admin-box">
        <button class="close-admin" onclick="fecharAdmin()">‚úï</button>
        <div id="adm-login-area">
            <h2 style="text-align:center">Painel Admin</h2>
            <input type="text" id="adm-user" class="admin-input" placeholder="Usu√°rio">
            <input type="password" id="adm-pass" class="admin-input" placeholder="Senha">
            <button onclick="login()" class="btn-play" style="width:100%; justify-content:center;">ENTRAR</button>
        </div>
        <div id="adm-painel" style="display:none;">
            <h3>Publicar Conte√∫do</h3>
            <div style="display:flex; gap:10px; margin-bottom:10px;">
                <button onclick="setTipo('movie')" id="btn-m" style="flex:1; padding:10px; background:var(--red); color:white; border:none;">FILME</button>
                <button onclick="setTipo('tv')" id="btn-t" style="flex:1; padding:10px; background:#333; color:white; border:none;">S√âRIE</button>
            </div>
            <input type="text" id="adm-busca" class="admin-input" placeholder="Buscar no TMDB..." oninput="buscarTMDB()">
            <div id="res-busca-adm" style="max-height:100px; overflow-y:auto; background:#000; margin-bottom:10px;"></div>
            
            <div id="campos-serie" style="display:none; background:#222; padding:10px; border-radius:8px; margin-bottom:10px;">
                <input type="number" id="ed-temp" class="admin-input" placeholder="Temporada (Ex: 1)">
                <input type="number" id="ed-ep" class="admin-input" placeholder="Epis√≥dio (Ex: 5)">
            </div>

            <input type="text" id="ed-link" class="admin-input" placeholder="Link do V√≠deo (.mp4 ou embed)">
            <button onclick="salvar()" class="btn-play" style="width:100%; justify-content:center;">PUBLICAR GLOBALMENTE</button>
        </div>
    </div>
</div>

<script>
    const DATABASE_URL = "https://cinetek-db692-default-rtdb.firebaseio.com/.json"; 
    const API_KEY = "6442432c527127fa62c7fe3b9774b7eb";

    let db = { movie:{}, tv:{}, recentes:[], config:{user:'admin', pass:'1234'} };
    let tipoAtual = 'movie'; let selecionado = null; let sliderItems = [];

    async function carregarBancoNuvem() {
        try {
            const r = await fetch(DATABASE_URL);
            const dados = await r.json();
            if (dados) { db = dados; render(db.recentes || [], 'grid-recentes'); }
        } catch (e) { console.error("Erro banco"); }
    }

    async function salvarNaNuvem() {
        await fetch(DATABASE_URL, { method: 'PUT', body: JSON.stringify(db) });
    }

    async function init() {
        await carregarBancoNuvem();
        const r = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json(); sliderItems = d.results.slice(0, 8);
        render(d.results, 'main-grid'); startSlider();
    }

    function startSlider() {
        let idx = 0; setInterval(() => {
            const m = sliderItems[idx]; if(m) {
                document.getElementById('hero-slider').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
                document.getElementById('hero-tit').innerText = m.title || m.name; idx = (idx + 1) % sliderItems.length;
            }
        }, 6000);
    }

    function render(lista, container) {
        const div = document.getElementById(container); div.innerHTML = "";
        lista.forEach(m => {
            if(!m.poster_path) return;
            const card = document.createElement('div'); card.className = 'card';
            card.innerHTML = `<img src="https://image.tmdb.org/t/p/w500${m.poster_path}"><p>${m.title || m.name}</p>`;
            card.onclick = () => abrirDet(m); div.appendChild(card);
        });
    }

    async function abrirDet(m) {
        selecionado = m; const tipo = m.name ? 'tv' : 'movie';
        const page = document.getElementById('detalhes-page');
        page.style.backgroundImage = `url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
        document.getElementById('det-tit').innerText = m.title || m.name;
        document.getElementById('det-poster').src = `https://image.tmdb.org/t/p/w500${m.poster_path}`;
        document.getElementById('det-meta').innerText = `‚≠ê ${m.vote_average.toFixed(1)} | ${m.release_date || m.first_air_date || ""}`;
        document.getElementById('det-sinopse').innerText = m.overview || "Sinopse n√£o dispon√≠vel.";
        
        const pBox = document.getElementById('player-box'); const sArea = document.getElementById('series-area'); const btnPlay = document.getElementById('btn-play-trigger');
        pBox.style.display = 'none'; sArea.style.display = 'none';

        if(tipo === 'tv') {
            btnPlay.style.display = 'none'; sArea.style.display = 'block'; carregarTemporadas(m.id);
        } else {
            btnPlay.style.display = 'inline-flex';
            btnPlay.onclick = () => {
                if(db.movie && db.movie[m.id]) { 
                    pBox.style.display = 'block'; 
                    document.getElementById('main-video').src = db.movie[m.id].link; 
                    btnPlay.style.display = 'none';
                } else alert("Em breve!");
            };
        }
        const rs = await fetch(`https://api.themoviedb.org/3/${tipo}/${m.id}/similar?api_key=${API_KEY}&language=pt-BR`);
        const ds = await rs.json(); render(ds.results.slice(0, 6), 'grid-semelhantes');
        page.style.display = 'block'; page.scrollTo(0, 0);
    }

    async function carregarTemporadas(id) {
        const r = await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json(); document.getElementById('select-temp').innerHTML = d.seasons.map(s => `<option value="${s.season_number}">${s.name}</option>`).join('');
        carregarEpisodios();
    }

    async function carregarEpisodios() {
        const s = document.getElementById('select-temp').value;
        const r = await fetch(`https://api.themoviedb.org/3/tv/${selecionado.id}/season/${s}?api_key=${API_KEY}&language=pt-BR`);
        const d = await r.json();
        
        const listaHTML = d.episodes.map(e => {
            const idEp = `s${s}e${e.episode_number}`;
            const linkOk = db.tv && db.tv[selecionado.id] && db.tv[selecionado.id].eps && db.tv[selecionado.id].eps[idEp];
            const classe = linkOk ? "" : "bloqueado";
            return `<div class="ep-card ${classe}" onclick="tocarEp('${selecionado.id}', '${idEp}')"><b>EP ${e.episode_number}</b> - ${e.name} ${linkOk ? "‚ñ∂" : "üîí"}</div>`;
        }).join('');
        
        document.getElementById('ep-list').innerHTML = listaHTML;
    }

    function tocarEp(idSerie, idEp) {
        if(db.tv && db.tv[idSerie] && db.tv[idSerie].eps && db.tv[idSerie].eps[idEp]) { 
            document.getElementById('player-box').style.display = 'block'; 
            document.getElementById('main-video').src = db.tv[idSerie].eps[idEp]; 
            document.getElementById('main-video').play();
        } else alert("Epis√≥dio ainda n√£o dispon√≠vel.");
    }

    function login() {
        if(document.getElementById('adm-user').value === db.config.user && document.getElementById('adm-pass').value === db.config.pass) {
            document.getElementById('adm-login-area').style.display = 'none'; document.getElementById('adm-painel').style.display = 'block';
        } else alert("Acesso negado!");
    }

    async function salvar() {
        const link = document.getElementById('ed-link').value; if(!selecionado || !link) return alert("Faltam dados!");
        const tipo = selecionado.name ? 'tv' : 'movie';
        
        if(!db[tipo]) db[tipo] = {};

        if(tipo === 'movie') {
            db.movie[selecionado.id] = { ...selecionado, link: link };
        } else {
            const s = document.getElementById('ed-temp').value;
            const e = document.getElementById('ed-ep').value;
            if(!s || !e) return alert("Informe Temporada e Epis√≥dio!");
            
            if(!db.tv[selecionado.id]) db.tv[selecionado.id] = { ...selecionado, eps: {} };
            if(!db.tv[selecionado.id].eps) db.tv[selecionado.id].eps = {};
            
            const idEp = `s${s}e${e.episode_number || e}`;
            db.tv[selecionado.id].eps[idEp] = link;
        }

        db.recentes = db.recentes.filter(x => x.id != selecionado.id);
        db.recentes.unshift(selecionado);
        if(db.recentes.length > 20) db.recentes.pop();

        await salvarNaNuvem();
        alert("Publicado com Sucesso!"); location.reload();
    }

    function setTipo(t) { 
        tipoAtual = t; 
        document.getElementById('btn-m').style.background = t=='movie'?'red':'#333'; 
        document.getElementById('btn-t').style.background = t=='tv'?'red':'#333'; 
        document.getElementById('campos-serie').style.display = t=='tv'?'block':'none';
    }

    async function buscarTMDB() {
        const q = document.getElementById('adm-busca').value; if(q.length < 3) return;
        const r = await fetch(`https://api.themoviedb.org/3/search/${tipoAtual}?api_key=${API_KEY}&query=${q}&language=pt-BR`);
        const d = await r.json();
        document.getElementById('res-busca-adm').innerHTML = d.results.map(m => `<div onclick='selecionado=${JSON.stringify(m).replace(/'/g, "")}; alert("Selecionado: "+(selecionado.title||selecionado.name))' style="padding:10px; cursor:pointer; border-bottom:1px solid #222;">${m.title || m.name}</div>`).join('');
    }

    function toggleMenu(s) { document.getElementById('menu-lat').classList.toggle('active', s); }
    function fecharDet() { document.getElementById('detalhes-page').style.display = 'none'; document.getElementById('main-video').src = ""; }
    function abrirAdmin() { document.getElementById('admin-modal').style.display = 'block'; }
    function fecharAdmin() { document.getElementById('admin-modal').style.display = 'none'; }
    async function pesquisaGeral() {
        const q = document.getElementById('home-search').value;
        const r = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${q}&language=pt-BR`);
        const d = await r.json(); render(d.results, 'main-grid');
    }
    async function buscarGen(id, tipo) {
        toggleMenu(false);
        let url = id === 0 ? `https://api.themoviedb.org/3/trending/${tipo}/week?api_key=${API_KEY}&language=pt-BR` : `https://api.themoviedb.org/3/discover/${tipo}?api_key=${API_KEY}&with_genres=${id}&language=pt-BR`;
        const r = await fetch(url); const d = await r.json(); render(d.results, 'main-grid');
    }

    init();
</script>
</body>
</html>
